{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/class-name-casing */\r\n/* eslint-disable @typescript-eslint/no-empty-interface */\r\nconst Reflect = window.Reflect;\r\ninterface ClassConstructor {\r\n    new (): HTMLElement;\r\n    prototype: HTMLElement;\r\n}\r\nconst {\r\n    get: get,\r\n    getPrototypeOf: getPrototypeOf,\r\n    has: has,\r\n    set: set\r\n} = Reflect;\r\n\r\nfunction isobject(a: any) {\r\n    return typeof a === \"object\" && a !== null;\r\n}\r\n\r\nfunction isfunction(a: any) {\r\n    return typeof a === \"function\";\r\n}\r\n\r\nfunction isclassextendsHTMLElement(\r\n    initclass: any\r\n): initclass is ClassConstructor {\r\n    return !!(\r\n        isfunction(initclass) &&\r\n        initclass.prototype &&\r\n        initclass.prototype instanceof HTMLElement\r\n    );\r\n}\r\n\r\nconst invalid_custom_element_class = \"invalid custom element class !\";\r\n\r\nif (!isobject(window.customElements)) {\r\n    console.error(\" customElements  not supported !\");\r\n    throw new TypeError();\r\n}\r\n\r\nfunction 使用value从表中查询key(\r\n    表: { [s: string]: ClassConstructor },\r\n    组件状态名: ClassConstructor\r\n) {\r\n    const outputentrie = Object.entries(表).find(v => {\r\n        return v[1] === 组件状态名;\r\n    });\r\n    return outputentrie ? outputentrie[0] : undefined;\r\n}\r\n\r\nwindow.CustomElementRegistry = get(\r\n    getPrototypeOf(window.customElements),\r\n    \"constructor\"\r\n);\r\n\r\nconst elementset = Symbol.for(\"elementset\");\r\n\r\nconst elementmap = Symbol.for(\"elementmap\");\r\n\r\nconst { CustomElementRegistry: CustomElementRegistry } = window;\r\n\r\nconst customElements: customElementsclass = window.customElements as customElementsclass;\r\ninterface customElementsclass extends CustomElementRegistry {\r\n    [elementmap]: Record<string, ClassConstructor>;\r\n    [elementset]: Set<ClassConstructor>;\r\n}\r\nif (!has(customElements, elementset)) {\r\n    set(customElements, elementset, new Set());\r\n}\r\n\r\nif (!has(customElements, elementmap)) {\r\n    set(customElements, elementmap, Object.create(null));\r\n}\r\n\r\nvar RandomDefine = (initclass: ClassConstructor, extendsname: string) =>\r\n    RandomDefineCustomElement(initclass, extendsname);\r\n\r\nfunction RandomDefineCustomElement(\r\n    initclass: ClassConstructor,\r\n    extendsname?: string,\r\n    length = 1\r\n): string {\r\n    if (!isclassextendsHTMLElement(initclass)) {\r\n        console.error(initclass);\r\n        console.error(invalid_custom_element_class);\r\n        throw TypeError();\r\n    }\r\n    if (!get(customElements, elementset).has(initclass)) {\r\n        const elementname = getrandomstringandnumber(length);\r\n        if (customElements.get(elementname)) {\r\n            return RandomDefineCustomElement(\r\n                initclass,\r\n                extendsname,\r\n                length + 1\r\n            );\r\n        } else {\r\n            if (extendsname) {\r\n                customElements.define(elementname, initclass, {\r\n                    extends: extendsname\r\n                });\r\n            } else {\r\n                customElements.define(elementname, initclass);\r\n            }\r\n        }\r\n        return elementname;\r\n    } else {\r\n        return 使用value从表中查询key(\r\n            get(customElements, elementmap),\r\n            initclass\r\n        ) as string;\r\n    }\r\n}\r\ninterface CustomElementConstructor {\r\n    new (): HTMLElement;\r\n}\r\ncustomElements.define = function(\r\n    name: string,\r\n    constructor: CustomElementConstructor,\r\n    options?: ElementDefinitionOptions\r\n) {\r\n    if (!isclassextendsHTMLElement(constructor)) {\r\n        console.error(constructor);\r\n        console.error(invalid_custom_element_class);\r\n        throw TypeError();\r\n    }\r\n    if (!get(customElements, elementset).has(constructor)) {\r\n        if (has(customElements[elementmap], name)) {\r\n            RandomDefineCustomElement(\r\n                constructor,\r\n                options ? options.extends : undefined\r\n            );\r\n        } else {\r\n            CustomElementRegistry.prototype.define.call(\r\n                customElements,\r\n                name,\r\n                constructor,\r\n                options\r\n            );\r\n            customElements[elementset].add(constructor);\r\n            customElements[elementmap][name] = constructor;\r\n        }\r\n    }\r\n};\r\n\r\nset(customElements, Symbol.iterator, () => {\r\n    const entries = Object.entries(customElements[elementmap]);\r\n    return entries[Symbol.iterator].call(entries);\r\n});\r\n\r\nconst charactorlist = Array(26)\r\n    .fill(undefined)\r\n    .map((v, i) => 97 + i)\r\n    .map(n => String.fromCharCode(n));\r\n\r\nconst hexnumberlist = Array(16)\r\n    .fill(undefined)\r\n    .map((v, i) => i)\r\n    .map(a => a.toString(16));\r\n\r\nconst charactorandnumberlist = [\r\n    ...new Set([...hexnumberlist, ...charactorlist])\r\n];\r\n\r\nfunction getrandomcharactor() {\r\n    return get(charactorlist, Math.floor(Math.random() * charactorlist.length));\r\n}\r\n\r\nfunction getrandomhexnumberandcharactor() {\r\n    return get(\r\n        charactorandnumberlist,\r\n        Math.floor(Math.random() * charactorandnumberlist.length)\r\n    );\r\n}\r\n\r\nfunction getrandomstringandnumber(length = 1) {\r\n    return (\r\n        Array(length)\r\n            .fill(undefined)\r\n            .map(() => getrandomcharactor())\r\n            .join(\"\") +\r\n        \"-\" +\r\n        Array(length)\r\n            .fill(undefined)\r\n            .map(() => getrandomhexnumberandcharactor())\r\n            .join(\"\")\r\n    );\r\n}\r\n\r\nexport default RandomDefine;\r\n//# sourceMappingURL=index.js.map\r\n"],"names":["Reflect","window","get","getPrototypeOf","has","set","isobject","a","isfunction","isclassextendsHTMLElement","initclass","prototype","HTMLElement","invalid_custom_element_class","customElements","console","error","TypeError","使用value从表中查询key","表","组件状态名","outputentrie","Object","entries","find","v","undefined","CustomElementRegistry","elementset","Symbol","for","elementmap","Set","create","RandomDefine","extendsname","RandomDefineCustomElement","length","elementname","getrandomstringandnumber","define","extends","name","constructor","options","call","add","iterator","charactorlist","Array","fill","map","i","n","String","fromCharCode","hexnumberlist","toString","charactorandnumberlist","getrandomcharactor","Math","floor","random","getrandomhexnumberandcharactor","join"],"mappings":"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"}